<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>CMU15-445 Proj2.Extendible hash index</title>
    <link href="/2023/12/13/Proj2.Extendible%20hash%20index/"/>
    <url>/2023/12/13/Proj2.Extendible%20hash%20index/</url>
    
    <content type="html"><![CDATA[<p>å†™äº†å¾ˆä¹…çš„ä¸€ä¸ªprojï¼Œdebugè¿‡ç¨‹ç›¸å½“æŠ˜ç£¨ï¼Œæœ€ååœ¨å¹¶è¡Œæµ‹è¯•å°æ¦‚ç‡å‡ºé—®é¢˜çš„æƒ…å†µä¸‹æ½¦è‰æ»¡åˆ†å®Œæˆã€‚åç»­æœ‰æ—¶é—´å†è¿›è¡Œæ”¹æ­£å’Œä¼˜åŒ–ã€‚<br><strong>æ³¨æ„</strong>ï¼šæ­¤projéœ€è¦åœ¨proj1çš„æ”¯æ’‘ä¸‹å®Œæˆï¼ŒåŠ¡å¿…ç¡®ä¿proj1é€šè¿‡agæµ‹è¯•ã€‚</p><h1 id="Task1-Read-Write-Page-Guards"><a href="#Task1-Read-Write-Page-Guards" class="headerlink" title="Task1- Read&#x2F;Write Page Guards"></a>Task1- Read&#x2F;Write Page Guards</h1><p>å®ç° <code>BasicPageGuard</code>ï¼Œå®ƒå­˜å‚¨æŒ‡å‘ <code>BufferPoolManager</code> å’Œ <code>Page</code> å¯¹è±¡çš„æŒ‡é’ˆã€‚page guardç¡®ä¿åœ¨ç›¸åº”çš„ Page å¯¹è±¡è¶…å‡ºä½œç”¨åŸŸæ—¶ç«‹å³å¯¹å…¶è°ƒç”¨ <code>UnpinPage</code>ã€‚</p><p>éœ€è¦å¯¹<code>BasicPageGuard</code>,Â <code>ReadPageGuard</code>Â å’Œ<code>WritePageGuard</code>å®ç°è¿™å››ä¸ªå‡½æ•°ï¼š</p><ul><li><code>PageGuard(PageGuard &amp;&amp;that)</code>: Move constructor.</li><li><code>operator=(PageGuard &amp;&amp;that)</code>: Move operator.</li><li><code>Drop()</code>: Unpin and&#x2F;or unlatch.</li><li><code>~PageGuard()</code>: Destructor.</li></ul><h2 id="BasicPageGuard"><a href="#BasicPageGuard" class="headerlink" title="BasicPageGuard"></a>BasicPageGuard</h2><p>å¯¹äº<code>BasicPageGuard</code>ï¼Œæ³¨é‡Šå†™çš„å¾ˆè¯¦ç»†ï¼Œè¦æ³¨æ„çš„æ˜¯åœ¨<strong>ç§»åŠ¨èµ‹å€¼</strong>å‡½æ•°ä¸­ï¼Œè‡ªå·±æœ¬èº«å¯èƒ½å·²ç»æŒ‡å‘ä¸€ä¸ªé¡µé¢(å¦‚æ³¨é‡Šä¸­æ‰€è¯´ï¼šassumes that BasicPageGuard already has a page being guarded)ï¼Œéœ€è¦å°†è‡ªå·±æ¸…ç©ºä¸”unpin(ä¹Ÿå°±æ˜¯è°ƒç”¨Drop)ã€‚</p><p>Dropå‡½æ•°ä¸­è¦å¯¹pageæ˜¯å¦ä¸ºç©ºè¿›è¡Œæ£€æŸ¥ã€‚</p><h2 id="ReadPageGuard-WritePageGuard"><a href="#ReadPageGuard-WritePageGuard" class="headerlink" title="ReadPageGuard WritePageGuard"></a>ReadPageGuard WritePageGuard</h2><ol><li>ç”±äºå·²ç»å¯¹guard_ç±»(BasicPageGuard)å®ç°äº†ç§»åŠ¨èµ‹å€¼å‡½æ•°ï¼Œåœ¨æ„é€ å’Œç§»å€¼æ—¶å¯ä»¥å¯¹guard_ç›´æ¥ä½¿ç”¨<code>std::move()</code>,è¿™é‡Œæˆ‘ä»¬ä¸ç”¨å†å»æ¸…é™¤<code>that.guard_</code>çš„å†…å®¹(åœ¨BasicPageGuardä¸­çš„ç§»åŠ¨èµ‹å€¼å‡½æ•°ä¸­å¯¹thatè¿›è¡Œäº†æ¸…é™¤)</li><li>åœ¨æ‹¿å–thatçš„guard_å†…å®¹æ—¶ï¼Œè¦æ³¨æ„å¯¹å…¶é”çš„é‡Šæ”¾ï¼Œåœ¨Dropæ—¶ï¼Œä¹Ÿè¦æ³¨æ„é‡Šæ”¾é”ã€‚(è¿™é‡ŒåŒæ ·è¦å¯¹é¡µæœ¬èº«è¿›è¡Œæ£€æŸ¥æ˜¯å¦ä¸ºç©ºï¼Œé¿å…é‡å¤é‡Šæ”¾é”)</li></ol><h2 id="UpgradeRead-UpgradeWrite"><a href="#UpgradeRead-UpgradeWrite" class="headerlink" title="UpgradeRead UpgradeWrite"></a>UpgradeRead UpgradeWrite</h2><p>çºµè§‚æ•´ä¸ªprojï¼Œæˆ‘éƒ½æ²¡æœ‰ç”¨åˆ°è¿‡è¿™ä¸¤ä¸ªå‡½æ•°ï¼ŒåŸå› æ˜¯æˆ‘å¯¹æ³¨é‡Šä¸­è¯´çš„(The protected page is not evicted from the buffer pool during the upgrade)å›°æƒ‘ï¼Œæ„Ÿè§‰å¾ˆéš¾å®ç°ï¼Œä¹‹åå¦‚æœæœ‰æ—¶é—´æˆ–è€…è¦ç”¨åˆ°çš„æ—¶å€™å†å›æ¥å¡«ä¸ªå‘â€¦</p><p>ä¸¤ä¸ªå‡½æ•°çš„ä½¿ç”¨çš„åœºæ™¯å¾ˆæ˜äº†ï¼Œå› ä¸ºåœ¨bpmä¸­ï¼Œæˆ‘ä»¬åªæœ‰<code>NewPageGuarded</code>ï¼Œè€Œæ²¡æœ‰<code>NewReadPageGuarded</code>(or <code>NewWritePageGuarded</code>)ï¼Œå› æ­¤å¦‚æœæƒ³è¦ç›´æ¥ç”³è¯·ä¸€ä¸ª<code>ReadGuard </code>or <code>WriteGuard</code>ï¼Œæˆ‘ä»¬åªèƒ½<code>NewPageGuarded</code>åUpgrade.</p><p>å®ç°çš„æ€è·¯è·ŸBasicPageGuardçš„ç§»åŠ¨æ„é€ ç›¸ä¼¼ï¼Œä¸è¿‡è¿™é‡Œæ˜¯å°†è‡ªå·±çš„å†…å®¹æ¸…ç©ºã€‚</p><h2 id="NewGuard-FetchGuard"><a href="#NewGuard-FetchGuard" class="headerlink" title="NewGuard FetchGuard"></a>NewGuard FetchGuard</h2><p>åœ¨bpmä¸­å®ç°ï¼š</p><ul><li><code>FetchPageBasic(page_id_t page_id)</code></li><li><code>FetchPageRead(page_id_t page_id)</code></li><li><code>FetchPageWrite(page_id_t page_id)</code></li><li><code>NewPageGuarded(page_id_t *page_id)</code><br>å®ç°å¾ˆç®€å•ï¼šè°ƒç”¨bpmä¸­çš„å‡½æ•°å¾—åˆ°é¡µï¼Œç„¶åè¿”å›ç›¸åº”çš„Guard,åœ¨<code>FetchPageRead</code>å’Œ<code>FetchPageWrite</code>ä¸­è¦æ³¨æ„æ‹¿è¯»å†™é”ã€‚</li></ul><h1 id="Task2-Extendible-Hash-Table-Pages"><a href="#Task2-Extendible-Hash-Table-Pages" class="headerlink" title="Task2 Extendible Hash Table Pages"></a>Task2 Extendible Hash Table Pages</h1><p><img src="/../images/20.png"></p><h2 id="Header-page"><a href="#Header-page" class="headerlink" title="Header_page"></a>Header_page</h2><p>è·Ÿä»¥å¾€çš„ç»“æ„ä¸åŒï¼Œ23fallä½¿ç”¨äº†ä¸‰å±‚ç»“æ„(å¤šäº†header)ï¼Œheaderå®ç°äº†å¯¹äºç›®å½•é¡µçš„æ˜ å°„ï¼Œ(åº”è¯¥æ˜¯ä¸‰å±‚ç»“æ„ä¸­æœ€ç®€å•çš„ä¸€å±‚):<br>è¦å®ç°å‡ ä¸ªAPI(Setã€Getã€Sizeå°±ä¸æåŠäº†)ï¼š</p><h3 id="Init"><a href="#Init" class="headerlink" title="Init"></a>Init</h3><p>èµ‹å€¼ä¼ å…¥çš„max_depth,å¹¶å°†å­˜å‚¨ç›®å½•-&gt;page_idçš„æ˜ å°„åˆå§‹åŒ–ä¸º<code>INVALID_PAGE_ID</code>å³å¯ã€‚</p><h3 id="HashToDirectoryIndex"><a href="#HashToDirectoryIndex" class="headerlink" title="HashToDirectoryIndex"></a>HashToDirectoryIndex</h3><p>è¿™é‡Œçœ‹æµ‹è¯•ï¼š<br><strong>00</strong>000000000000001000000000000000 - 32768<br><strong>01</strong>000000000000001000000000000000 - 1073774592<br><strong>10</strong>000000000000001000000000000000 - 2147516416<br><strong>11</strong>000000000000001000000000000000 - 3221258240</p><p>ä¸éš¾å‘ç°æ˜¯æ ¹æ®é«˜max_depthä½æ¥ä½œæ˜ å°„ï¼Œå› æ­¤æˆ‘ä»¬å–å‰max_depthä½ï¼Œæ–¹å¼ä¸ºhash &gt;&gt; (32-max_depth)ï¼Œ&#x3D;&#x3D;è¿™é‡Œæ³¨æ„max_depthä¸º0çš„æƒ…å†µ&#x3D;&#x3D;ï¼Œå³ç§»32ä½ä¼šå¾—åˆ°éæ³•å€¼ï¼Œå› æ­¤ç›´æ¥return 0å³å¯ã€‚</p><h2 id="Directory-Page"><a href="#Directory-Page" class="headerlink" title="Directory_Page"></a>Directory_Page</h2><p>æœ€å¤æ‚çš„ä¸€å±‚ï¼Œåœ¨extendible hashingä¸­ï¼Œä¸åŒçš„directory_idxå¯èƒ½æŒ‡å‘åŒä¸€ä¸ªbucket,ç‰¹åˆ«æ˜¯åœ¨directory merge or directory splitä¸­ï¼Œè¦å°†å˜åŒ–åŒæ­¥.</p><h3 id="ç»“æ„è®¤çŸ¥"><a href="#ç»“æ„è®¤çŸ¥" class="headerlink" title="ç»“æ„è®¤çŸ¥"></a>ç»“æ„è®¤çŸ¥</h3><p>æ¥çœ‹ä¸€ä¸ªä¾‹å­:<br><img src="/../images/21.png"></p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">assume head_pageid = 0,directory pageid = 1,bucket_max_size = 3<br>======== DIRECTORY (global_depth_: 1) ========<br>|<span class="hljs-string"> bucket_idx </span>|<span class="hljs-string"> page_id </span>|<span class="hljs-string"> local_depth </span>|<br>|<span class="hljs-string"> 0 </span>|<span class="hljs-string"> 2 </span>|<span class="hljs-string"> 1 </span>|<br>|<span class="hljs-string"> 1 </span>|<span class="hljs-string"> 3 </span>|<span class="hljs-string"> 1 </span>|<br>================ END DIRECTORY ================<br></code></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬è¦æ’å…¥22ï¼Œbucketæ»¡äº†ï¼Œéœ€è¦å¢åŠ bucketçš„æœ¬åœ°æ·±åº¦å’Œç›®å½•é¡µçš„å…¨å±€æ·±åº¦ï¼Œå¹¶rehashè¿™å››ä¸ªå€¼åˆ°æ­£ç¡®çš„æ¡¶ä¸­ï¼Œæ­¤æ—¶è¿™å››ä¸ªæ•°æ ¹æ®2ä½æ¥åˆ†é…ï¼š</p><ul><li>16:100<strong>00</strong>   4: 001<strong>00</strong></li><li>6: 001<strong>10</strong>   22:101<strong>10</strong><br>å› æ­¤16å’Œ4å»åˆ°ç¬¬ä¸€ä¸ªæ¡¶(idx&#x3D;00)ï¼Œ6å’Œ22å»åˆ°ç¬¬ä¸‰ä¸ªæ¡¶(idx&#x3D;10)<br>ä»…ä»…åˆ°è¿™ï¼Œæˆ‘ä»¬çš„ç›®å½•åº”è¯¥æ˜¯è¿™æ ·çš„:<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">======== DIRECTORY (global_depth_: 2) ========<br>|<span class="hljs-string"> bucket_idx </span>|<span class="hljs-string"> page_id </span>|<span class="hljs-string"> local_depth </span>|<br>|<span class="hljs-string"> 0 </span>|<span class="hljs-string"> 2 </span>|<span class="hljs-string"> 2 </span>|<br>|<span class="hljs-string"> 1 </span>|<span class="hljs-string"> 3 </span>|<span class="hljs-string"> 1 </span>|<br>|<span class="hljs-string"> 2 </span>|<span class="hljs-string"> 4 </span>|<span class="hljs-string"> 2 </span>|<br>|<span class="hljs-string"> 3 </span>|<span class="hljs-string"> ? </span>|<span class="hljs-string"> ? </span>|<br>================ END DIRECTORY ================<br></code></pre></td></tr></table></figure>çœ‹æœ€ç»ˆç»“æœï¼Œæˆ‘ä»¬ç¼ºå°‘äº†æŠŠç¬¬å››ä¸ªæ¡¶(idx&#x3D;11)æŒ‡å‘pageidä¸º3çš„é¡µçš„æ˜ å°„è¿‡ç¨‹ã€‚<br><img src="/../images/22.png"><br>æˆ‘ä»¬æƒ³è¦çš„ç»“æœæ˜¯ï¼š<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">======== DIRECTORY (global_depth_: 2) ========<br>|<span class="hljs-string"> bucket_idx </span>|<span class="hljs-string"> page_id </span>|<span class="hljs-string"> local_depth </span>|<br>|<span class="hljs-string"> 0 </span>|<span class="hljs-string"> 2 </span>|<span class="hljs-string"> 2 </span>|<br>|<span class="hljs-string"> 1 </span>|<span class="hljs-string"> 3 </span>|<span class="hljs-string"> 1 </span>|<br>|<span class="hljs-string"> 2 </span>|<span class="hljs-string"> 4 </span>|<span class="hljs-string"> 2 </span>|<br>|<span class="hljs-string"> 3 </span>|<span class="hljs-string"> 3 </span>|<span class="hljs-string"> 1 </span>|<br>================ END DIRECTORY ================<br></code></pre></td></tr></table></figure>å› æ­¤ï¼Œè¿™é‡Œ<code>IncrGlobalDepth</code>è¦åšçš„å¦ä¸€ä»¶äº‹(ä¸€ä»¶æ˜¯global_depth++)æ˜¯å°†æ–°çš„ä¸è¢«è®¾ç½®æŒ‡å‘pageçš„bucket_idxï¼ŒæŒ‡å‘ä»–ä»¬åº”è¯¥æŒ‡å‘çš„ï¼Œè€Œè¿™é‡Œåº”è¯¥æŒ‡å‘çš„å°±æ˜¯<strong>SplitImageIndex</strong>ï¼Œå…¶å®ä¸Šé¢åˆ†å‰²æ»¡æ¡¶çš„è¿‡ç¨‹ä¸­ï¼Œå°±å·²ç»ç”¨åˆ°äº†åˆ†å‰²æ˜ åƒ(00-10)ã€‚<br>é‚£ä¹ˆ11çš„SplitImageIndexåº”è¯¥æ˜¯è°ï¼Ÿæƒ³è±¡æˆ‘ä»¬å†æ’å…¥ä¸€ç³»åˆ—å¥‡æ•°:1ã€3ã€5ã€7ï¼Œæ­¤æ—¶ç¬¬äºŒä¸ªæ¡¶æ»¡äº†ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ1357å†åˆ†æˆä¸¤ç»„:</li><li>1: 00<strong>01</strong> 5: 01<strong>01</strong></li><li>3: 00<strong>11</strong> 7: 01<strong>11</strong><br>æ˜¾ç„¶ï¼Œ01å’Œ11æ˜¯ä¸€ç»„ï¼Œåˆ°è¿™ï¼Œç›¸ä¿¡è¯»è€…å·²ç»æœ‰ä¸€ç§æ„Ÿè§‰äº†ï¼Œè¿™ä¸å°±æ˜¯å°†ç¬¬äºŒä½ä¸1å¼‚æˆ–å˜›ï¼Ÿ:</li><li>00 ^ 10 &#x3D; 10</li><li>01 ^ 10 &#x3D; 11<br>è¿™é‡Œç¬¬äºŒä¸ªæ•°æ˜¯é€šè¿‡(1 &lt;&lt; depth)ç”Ÿæˆçš„ï¼Œè€Œdepthæ˜¯å–global_depthè¿˜æ˜¯local_depthï¼Ÿåˆæˆ–è€…åœ¨åé¢directory shrinkçš„è¿‡ç¨‹ä¸­ï¼Œä¼šä¸ä¼šä¸ä¸€æ ·ï¼Ÿäº¤ç»™è¯»è€…è‡ªå·±æ€è€ƒã€‚</li></ul><p>å‡ ä¸ªapiå®ç°ï¼š</p><h3 id="Init-1"><a href="#Init-1" class="headerlink" title="Init"></a>Init</h3><p>èµ‹å€¼max_depthï¼Œå¯¹å…¨å±€æ·±åº¦å’Œå±€éƒ¨æ·±åº¦åˆå§‹åŒ–ä¸º0ï¼Œå°†bucket-&gt;page_idçš„æ˜ å°„åˆå§‹åŒ–ä¸ºINVALID.</p><h3 id="HashToBucketIndex"><a href="#HashToBucketIndex" class="headerlink" title="HashToBucketIndex"></a>HashToBucketIndex</h3><p>è§‚å¯Ÿä¸Šè¿°ä¾‹å­ï¼Œæ˜“çŸ¥bucket_idxä¸º hash % size</p><h3 id="CanShrink"><a href="#CanShrink" class="headerlink" title="CanShrink"></a>CanShrink</h3><p>æ ¹æ®æ–‡æ¡£æ‰€è¯´ï¼Œåªæœ‰å½“æ¯ä¸ªbucketçš„æœ¬åœ°æ·±åº¦éƒ½å°äºå…¨å±€æ·±åº¦æ—¶ï¼Œæ‰å¯ä»¥è¿›è¡Œç›®å½•Shrinkã€‚</p><h3 id="SetLocalDepth"><a href="#SetLocalDepth" class="headerlink" title="SetLocalDepth"></a>SetLocalDepth</h3><p>è¦åŒæ—¶å¯¹splitimageindexä½œåŒæ­¥ï¼Œå¦‚ä¸Šè¿°ä¾‹å­ä¸­ï¼Œè‹¥è¦æ”¹å˜ç¬¬äºŒä¸ªæ¡¶çš„æœ¬åœ°æ·±åº¦ï¼Œç¬¬å››ä¸ªæ¡¶çš„æœ¬åœ°æ·±åº¦åº”è¯¥ä¹Ÿå˜åŒ–ã€‚(å› ä¸ºä¿©è€…æŒ‡å‘çš„æ˜¯åŒä¸€é¡µ)</p><h2 id="Bucket-Page"><a href="#Bucket-Page" class="headerlink" title="Bucket_Page"></a>Bucket_Page</h2><p>è¿™ä¸€å±‚æ˜¯å®é™…å­˜å‚¨é”®å€¼å¯¹çš„ã€‚å‡ ä¸ªå‡½æ•°å®ç°éƒ½å¾ˆç®€å•ï¼Œæ— éæ˜¯å¯¹array_å­˜å‚¨çš„é”®å€¼å¯¹çš„æ“ä½œï¼Œä¸è¿‡å¤šèµ˜è¿°ã€‚</p><h3 id="Init-2"><a href="#Init-2" class="headerlink" title="Init"></a>Init</h3><p>èµ‹å€¼max_sizeï¼Œåˆå§‹åŒ–sizeï¼Œå°†array_å­˜çš„é”®å€¼å¯¹åˆå§‹åŒ–ä¸º<code>&#123;&#123;-1&#125;, &#123;&#125;&#125;</code>ã€‚</p><h1 id="Task3-Extendible-Hashing-Implementation"><a href="#Task3-Extendible-Hashing-Implementation" class="headerlink" title="Task3 Extendible Hashing Implementation"></a>Task3 Extendible Hashing Implementation</h1><p>ä½¿ç”¨task2ä¸­å†™çš„ä¸‰å±‚ç´¢å¼•æ¥å®ç°å¯¹è®°å½•çš„æ’å…¥ã€åˆ é™¤å’Œç‚¹æœç´¢ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯ç»™ä¸€ä¸ªé”®å€¼å¯¹ï¼Œä¸€å±‚å±‚æ‰¾åˆ°ä»–è¯¥å»çš„bucket(å¦‚æœæœ‰)ã€‚<br>å…ˆè°ˆè°ˆæœ‰å…³å®ç°ç»†èŠ‚ï¼š</p><h3 id="Init-3"><a href="#Init-3" class="headerlink" title="Init"></a>Init</h3><p>å‚è€ƒæ–‡æ¡£æ‰€è¯´ï¼Œ<code>When you first create an empty hash table, it should only have the (one and only) header page. Directory pages and bucket pages should be created on demand.</code>è¿™é‡Œæˆ‘ä»¬åªéœ€è¦æ–°å»ºheadé¡µå¹¶ä¸”initå°±è¡Œã€‚å¯¹äºç›®å½•é¡µå’Œæ¡¶é¡µï¼Œåœ¨æ’å…¥çš„æ—¶å€™<strong>æŒ‰éœ€ç”Ÿæˆ</strong></p><h3 id="Indexing"><a href="#Indexing" class="headerlink" title="Indexing"></a>Indexing</h3><p>åœ¨æ“ä½œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šç¢°åˆ°ä¸¤ç§ç´¢å¼•ï¼Œheader-&gt;directory ï¼Œdirectory-&gt;bucketï¼ŒåŸºæœ¬çš„æµç¨‹éƒ½ä¸€æ ·ï¼Œå…ˆè·å–headerPageidï¼Œas(or asmut)è·å¾—headerï¼Œå†<code>HashToDirectoryIndex</code>ï¼Œå¾—åˆ°directory_idxï¼Œæ ¹æ®idxå¾—åˆ°page idï¼Œas(or asmut)è·å¾—directory ï¼Œå¯¹äºbucketåˆ™æ˜¯ç›¸åŒçš„æ­¥éª¤ã€‚</p><h3 id="Bucket-Splitting"><a href="#Bucket-Splitting" class="headerlink" title="Bucket Splitting"></a>Bucket Splitting</h3><p>åœ¨ä¸Šé¢task2ä¸­è®²directory_pageæ—¶å·²ç»æåˆ°ï¼Œè¯»è€…è‹¥ä¸æ¸…æ¥šå¯ä»¥å¾€å›å†çœ‹çœ‹ã€‚æ³¨æ„è¿™é‡Œç®€å•çš„åšæ³•æ˜¯<strong>æ’å…¥æ—¶</strong>å‘ç°æ¡¶æ»¡äº†å†Split,è€Œä¸æ˜¯å½“<strong>æ’å…¥å</strong>æ¡¶æ»¡äº†å°±Splitï¼Œæœ‰ç»†å¾®çš„å·®åˆ«ã€‚</p><h3 id="Bucket-Merging"><a href="#Bucket-Merging" class="headerlink" title="Bucket Merging"></a>Bucket Merging</h3><p>ä¸Splittingé’ˆå¯¹äºInsertä¸åŒï¼ŒMergingæ˜¯é’ˆå¯¹äºRemoveçš„ï¼Œæ ¹æ®æ–‡æ¡£æ‰€è¯´:<br><em>To keep things relatively simple, we provide the following rules for merging:<br>    1. Only empty buckets can be merged. åªæœ‰ç©ºæ¡¶å¯ä»¥è¢«åˆå¹¶ã€‚<br>    2. Buckets can only be merged with their split image if their split image has the same local depth.åªæœ‰æ¡¶å’Œå®ƒçš„åˆ†å‰²æ˜ åƒæ¡¶æœ‰ç›¸åŒçš„æœ¬åœ°æ·±åº¦æ—¶æ‰å¯ä»¥åˆå¹¶<br>    3. You should keep merging recursively if theÂ <strong>new split image</strong>Â of the merged bucket is empty.è‹¥åˆå¹¶åçš„æ¡¶çš„åˆ†å‰²æ˜ åƒæ¡¶ä¹Ÿæ˜¯ç©ºçš„ï¼Œåˆ™ç»§ç»­åˆå¹¶</em><br>è¿™é‡Œæ³¨æ„ï¼Œä¸æ˜¯å½“å‰æ¡¶å’Œå®ƒçš„åˆ†å‰²æ˜ åƒæ¡¶å¿…é¡»éƒ½æ˜¯ç©ºçš„æ‰èƒ½åˆå¹¶ï¼Œå®é™…åœºæ™¯åº”è¯¥æ˜¯ï¼š</p><ol><li>removeä¸€ä¸ªé”®å€¼å¯¹åï¼Œå½“å‰æ¡¶ç©ºäº†ï¼Œåˆ™è¿›è¡Œmergeï¼Œè€Œå¦‚æœå½“å‰æ¡¶éç©ºï¼Œsplit imageæ˜¯ç©ºçš„ï¼Œæ˜¯ä¸è¿›è¡Œåˆå¹¶çš„ã€‚</li><li>but åœ¨åˆå¹¶ä¸€æ¬¡åï¼Œå¦‚æœè¯¥åˆå¹¶æ¡¶çš„split imageæ˜¯ç©ºçš„ï¼Œåˆ™ä¸ç®¡å½“å‰æ¡¶æ˜¯å¦ç©ºï¼Œç»§ç»­åˆå¹¶ã€‚<br>å¤„ç†èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œremoveåï¼Œæ£€æŸ¥å½“å‰æ¡¶æ˜¯å¦ç©ºï¼Œè‹¥ç©ºåˆ™è°ƒç”¨mergeï¼Œè€Œmergeä¸­çš„æ¡ä»¶æ˜¯å½“å‰æ¡¶å’Œsplit imageä»»ä¸€ä¸ºç©ºã€‚</li></ol><p>åœ¨mergeä¸­éœ€è¦å°†æœ¬åœ°æ·±åº¦å‡ä¸€ï¼Œè¿™å°±ç›¸å½“äºsplitçš„æ—¶å€™è¦å°†æœ¬åœ°æ·±åº¦åŠ ä¸€ï¼Œmergeçš„æ„ä¹‰å°±æ˜¯ä¸éœ€è¦è¿™å¤šä¸€ä½çš„æ·±åº¦å³å¯å®Œæˆç´¢å¼•ã€‚</p><h3 id="Directory-Grow-or-Shrink"><a href="#Directory-Grow-or-Shrink" class="headerlink" title="Directory Grow or Shrink"></a>Directory Grow or Shrink</h3><ul><li>Grow: å½“bucketæ»¡æ—¶ï¼Œéœ€è¦å¢åŠ æœ¬åœ°æ·±åº¦ï¼Œå½“æœ¬åœ°æ·±åº¦å¤§äºå…¨å±€æ·±åº¦æ—¶ï¼Œå°±éœ€è¦directory growã€‚</li><li>Shirnk: åœ¨mergeåï¼Œæ£€æŸ¥Directory.Canshrinkã€‚trueåˆ™ç¼©å‡å…¨å±€æ·±åº¦ï¼Œæ³¨æ„æŠŠshrinkæ‰çš„bucketçš„pageidè®¾ä¸ºInvalid</li></ul><h3 id="Bugs"><a href="#Bugs" class="headerlink" title="Bugs"></a>Bugs</h3><ol><li><code>page -1 not in range </code>æ˜¯è®¿é—®åˆ°äº†ç©ºçš„directory or bucketï¼Œé—®é¢˜å°±æ˜¯æ²¡æœ‰æŒ‰éœ€ç”Ÿæˆæˆ–è€…æ²¡æœ‰åŠæ—¶returnã€‚æ¯”å¦‚insertæ—¶ä¸€è·¯èµ°ä¸‹å»ï¼Œæ²¡æœ‰directoryæˆ–è€…æ²¡æœ‰bucketæ—¶å°±è¦ç”Ÿæˆï¼Œ(ç”Ÿæˆåè®°å¾—æ›´æ–°æ˜ å°„ï¼‰è€Œremoveæˆ–è€…getvalueæ‰¾ä¸åˆ°æ—¶ï¼Œå°±ç›´æ¥return false.</li><li>æ³¨æ„ï¼š<code>For this semester, the hash table is intend to support onlyÂ **unique keys**. This means that the hash table should return false if the user tries to insert duplicate keys.</code>å½“æ’å…¥å·²æœ‰å€¼æ—¶ï¼Œç›´æ¥return false.</li><li>åœ¨agä¸Šçš„ä¸€äº›æµ‹è¯•ä¸­ï¼Œbpmçš„sizeåªæœ‰3ï¼Œè€Œheadpage,directorypageå·²ç»å äº†ä¸¤ä¸ªï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªé¡µå¯ä»¥ç”¨æ¥å­˜å‚¨bucketã€‚æ˜¾ç„¶ï¼Œæˆ‘ä»¬è¿™é‡Œéœ€è¦åŠæ—¶<code>drop</code>æ‰ä¸ç”¨çš„(ç”¨ä¸åˆ°çš„)headpageæˆ–è€…æ˜¯directorypageä»¥ä¾›bucketpageå­˜å‚¨.</li><li>å¦‚æœæ•ˆç‡ä¸è¶³ï¼Œå°è¯•ä¼˜åŒ–ä¹‹å‰çš„bpmã€‚<br>ç”±äºæ—¶é—´çº¿æœ‰ç‚¹é•¿ï¼Œæš‚æ—¶å°±æƒ³åˆ°è¿™ä¹ˆå¤šï¼Œæƒ³åˆ°å†æ›´æ–°ã€‚</li></ol><p>åšåˆ°è¿™ï¼Œå°±å¯ä»¥æ‰”agéªŒè¯task1ã€2ã€3çš„æ­£ç¡®æ€§äº†ã€‚å¾…èƒ½é€šè¿‡éå¹¶è¡Œæµ‹è¯•åï¼Œå†è¿›è¡Œtask4.(é€šä¸è¿‡çš„è¯å°±æ˜¯<strong>å¼€å¿ƒ</strong>çš„debugæ—¶é—´å•¦)</p><h1 id="Task4-Concurrency-Control"><a href="#Task4-Concurrency-Control" class="headerlink" title="Task4 Concurrency Control"></a>Task4 Concurrency Control</h1><p>ä½¿ç”¨task1å®ç°çš„Â <code>FetchPageWrite</code>Â <code>FetchPageRead</code>æ›¿æ¢ä¹‹å‰çš„BasicPageGuard(å¦‚æœç”¨äº†çš„è¯)<br>ç­–ç•¥å¤§æ¦‚æ˜¯ï¼š</p><ul><li>GetValue å…¨éƒ¨ä½¿ç”¨readguardï¼Œ</li><li>Insert å’ŒRemove å°½é‡ä½¿ç”¨writeguardï¼Œ(æ¯”å¦‚å› ä¸ºæˆ‘upgradeå‡½æ•°æ²¡æœ‰å®ç°å¥½ï¼Œå½“æˆ‘insertéœ€è¦æ–°å»ºbucketæ—¶å°±åªèƒ½ä½¿ç”¨basicguardï¼Œå¯èƒ½ä¹Ÿå› ä¸ºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘çš„å¹¶è¡Œæµ‹è¯•ä¼šæœ‰å°æ¦‚ç‡å‡ºç°é—®é¢˜)ã€‚</li><li>å› ä¸ºreadguardå’Œwriteguardæœ‰é”ï¼Œè®°å¾—åŠæ—¶dropä¸è¦çš„é¡µã€‚</li></ul><p>ç”±äºæ˜¯codeåå¤ç›˜å†™çš„æ–‡ç« ï¼Œå¯èƒ½æ‰€å¤„çš„é«˜åº¦ä¼šæœ‰äº›é«˜ï¼Œé€‚åˆå¯¹projæœ‰ä¸€å®šåŸºç¡€å’Œè®¤çŸ¥æ¥é˜…è¯»ï¼Œæ¬¢è¿æŒ‡æ­£å’Œå­¦ä¹ ã€‚</p><p>æœ€åé™„ä¸Šé€šè¿‡æˆªå›¾ï¼š<br><img src="/../images/23.png"></p><p>å‚è€ƒæ–‡ç« :<br><a href="https://www.geeksforgeeks.org/extendible-hashing-dynamic-approach-to-dbms/">å“ˆå¸Œè¡¨</a><br><a href="https://zihao256.github.io/p/517dd8ea.html">Project2: Extendible Hash Index</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>CMU15-445 Proj1.BUFFER POOL</title>
    <link href="/2023/11/26/Proj1.Buffer%20pool/"/>
    <url>/2023/11/26/Proj1.Buffer%20pool/</url>
    
    <content type="html"><![CDATA[<p>å…ˆæ”¾é€šè¿‡æˆªå›¾(23fa)ï¼š<br><img src="/../images/1.png"><br>è®°å½•ç¬”è€…ä½œä¸šCMU15-445(23fa)çš„proj1ä¸­çš„å®ç°å’Œè¸©è¿‡çš„å‘ï¼Œç¬¬ä¸€ä¸ªå‘:ç”±äºç¬”è€…åœ¨proj0çš„æ—¶å€™ä¸€ç›´è·Ÿç€2023spçš„åœ¨å†™ï¼Œåœ¨å†™pro1ä¸­å‘ç°ä»£ç ä¸­è¦æˆ‘ä½¿ç”¨disk_scheduleræ¥è°ƒåº¦ç£ç›˜çš„è¯»å†™ï¼Œè€Œ2023spé‡Œé¢çš„æ–‡æ¡£å¹¶æœªæåŠè¿™ä¸€ç‚¹ï¼Œåæ¥å‘ç°ç”±äºå…¶bustubæ—©å·²æ›´æ–°äº†2023façš„åº“ï¼Œè€Œæˆ‘å½“æ—¶cloneçš„ä¹Ÿå°±æ˜¯è¿™ä¸ªåº“(å‚»å‚»åœ°å¯¹ç€23spçš„æ–‡æ¡£å†™23façš„projâ€¦)ã€‚äºæ˜¯å°±è·‘å»è·Ÿ2023faäº†ï¼Œå¥½åœ¨Andyè€å¸ˆå¯¹äº2023faä¹Ÿå¼€æ”¾äº†lecå’Œagï¼Œ(è·ªäº†)ï¼Œä¸è¿‡agç°åœ¨(2023.11.26)åªå¼€æ”¾åˆ°proj2ï¼ŒæœŸå¾…åé¢çš„æ›´æ–°ã€‚</p><h2 id="Task1-LRU-K-Replacement-Policy"><a href="#Task1-LRU-K-Replacement-Policy" class="headerlink" title="Task1 - LRU-K Replacement Policy"></a>Task1 - LRU-K Replacement Policy</h2><p>å½“ç¼“å†²åŒºæ»¡æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ç§»å‡ºæŸä¸€å¸§ï¼Œä¸ºæ–°å¸§ç•™å‡ºä½ç½®ï¼Œè¿™é‡Œç”¨åˆ°çš„æ–¹æ³•æ˜¯çš„<code>LRU-K</code>ï¼Œæ˜¯LRU(Least Recently Used)çš„è¡ç”Ÿï¼Œåœ¨LRU-Kä¸­ï¼Œè¯„åˆ¤è§„åˆ™æ˜¯<code>backward k-distance</code>ï¼Œä»£è¡¨è¯¥å¸§åœ¨å½“å‰æ—¶é—´æˆ³å’Œå‰kæ¬¡æ—¶é—´æˆ³çš„å·®ï¼Œæ˜¾ç„¶è¿™ä¸ªæ—¶é—´å·®è¶Šé•¿ï¼Œä»£è¡¨æ­¤å¸§çš„ä½¿ç”¨é¢‘ç‡è¶Šå°ï¼Œæˆ‘ä»¬é©±é€çš„å°±æ˜¯<code>k-distance</code><strong>æœ€å¤§</strong>çš„å¸§ï¼Œè¿™å°±æ˜¯è¿™ä¸ªtaskè¦å®ç°çš„ï¼š<br>åœ¨<code>lru_k_replacer.h</code>å®ç°<code>LRUKReplacer</code>ç±»ï¼Œåœ¨<code>lru_k_replacer.cpp</code>å®ç°ç›¸åº”æ–¹æ³•:(æ³¨æ„åŠ é”ç¡®ä¿çº¿ç¨‹å®‰å…¨)</p><h3 id="Evict-frame-id-t-frame-id"><a href="#Evict-frame-id-t-frame-id" class="headerlink" title="Evict(frame_id_t* frame_id):"></a>Evict(frame_id_t* frame_id):</h3><p>é©±é€ä¸ <code>Replacer</code> æ­£åœ¨è·Ÿè¸ªçš„æ‰€æœ‰å…¶ä»–å¯é©±é€å¸§ç›¸æ¯”å…·æœ‰æœ€å¤§åå‘ k è·ç¦»çš„å¸§(è‹¥ä¸è¶³Kæ¬¡è®¿é—®ï¼Œåˆ™è®°k-distanceä¸º+infã€‚åœ¨è¾“å‡ºå‚æ•°ä¸­å­˜å‚¨å¸§ ID å¹¶è¿”å› Trueã€‚å¦‚æœæ²¡æœ‰å¯é©±é€çš„å¸§ï¼Œåˆ™è¿”å› Falseã€‚<br>è¿™é‡Œåˆ†ä¸ºä¸‰ç§æƒ…å†µï¼š</p><ol><li>æ— <code>k-distance</code>ä¸ºinfçš„å¸§ï¼šåˆ™å¯¹æ‰€æœ‰å¯é©±é€çš„å¸§è¿›è¡Œ<strong>LRU-K</strong>ç®—æ³•é©±é€</li><li>æœ‰ä¸€å¸§çš„<code>k-distance</code>ä¸ºinf:å¯¹å…¶é©±é€</li><li>å¤šå¸§çš„k-distanceä¸ºinfï¼Œ<strong>è¿™é‡Œéœ€è¦æ³¨æ„</strong> å®˜æ–¹æ–‡æ¡£åŠæ³¨é‡Šéƒ½å†™çš„æœ‰äº›æ™¦æ¶©ï¼Œç®€å•æ¥è¯´å°±æ˜¯é©±é€è¿™äº›å¸§ä¸­æœ€æ—©å‡ºç°çš„ã€‚å¦‚è€ƒè™‘è¿™ä¸ªreplacer_: k &#x3D; 3, è®°å½•åºåˆ—ä»æ—§åˆ°æ–°ä¸º:<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span><span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <br></code></pre></td></tr></table></figure>è¿™é‡Œ1å’Œ2éƒ½æœ‰<strong>3æ¬¡</strong>çš„è®¿é—®è®°å½•ï¼Œè€Œ3å’Œ4å°‘äº3æ¬¡ï¼Œå› æ­¤å±äºä¸Šè¿°çš„ç¬¬ä¸‰ç§æƒ…å†µï¼Œè¿™é‡ŒæŒ‰ç…§LRUçš„ç­–ç•¥ï¼Œæˆ‘ä»¬åº”è¯¥é©±é€æœ€è¿‘æœ€æ—§çš„è®¿é—®ï¼Œä¹Ÿå°±æ˜¯4ã€‚ä½†æ˜¯åœ¨LRU-Kçš„è®¿é—®ä¸­ï¼Œæˆ‘ä»¬å°±ç®€å•åœ°é©±é€æœ€æ—©å‡ºç°çš„å¸§ï¼Œè¿™é‡Œä¹Ÿå°±æ˜¯3.</li></ol><h3 id="RecordAccess-frame-id-t-frame-id"><a href="#RecordAccess-frame-id-t-frame-id" class="headerlink" title="RecordAccess(frame_id_t frame_id) :"></a>RecordAccess(frame_id_t frame_id) :</h3><p>è®°å½•ç»™å®šå¸§ ID åœ¨å½“å‰æ—¶é—´æˆ³è¢«è®¿é—®çš„æƒ…å†µã€‚åœ¨ä»£ç ä¸­è¡¨ç°ä¸ºæ›´æ–°æŒ‡å®š<code>LRUKNode</code>çš„historyã€‚è®°å¾—è‡ªå·±æ‰‹åŠ¨å¢åŠ å½“å‰æ—¶é—´æˆ³ã€‚</p><h3 id="Remove-frame-id-t-frame-id"><a href="#Remove-frame-id-t-frame-id" class="headerlink" title="Remove(frame_id_t frame_id):"></a>Remove(frame_id_t frame_id):</h3><p>æ¸…é™¤ä¸ä¸€ä¸ªå¸§ç›¸å…³çš„æ‰€æœ‰è®¿é—®å†å²è®°å½•ã€‚å°†å¸§ä»å¸§mapä¸­åˆ é™¤ï¼ŒåŒæ—¶å‡å°<code>LRUKReplacer</code> çš„å¤§å°ã€‚</p><h3 id="SetEvictable-frame-id-t-frame-id-bool-set-evictable"><a href="#SetEvictable-frame-id-t-frame-id-bool-set-evictable" class="headerlink" title="SetEvictable(frame_id_t frame_id, bool set_evictable) :"></a>SetEvictable(frame_id_t frame_id, bool set_evictable) :</h3><p>è¯¥æ–¹æ³•æ§åˆ¶å¸§æ˜¯å¦å¯é©±é€ã€‚å¹¶ä¸”æ§åˆ¶ <code>LRUKReplacer</code> çš„å¤§å°ã€‚(æ³¨æ„ä¸èƒ½ä»…æ ¹æ®è¦è®¾ç½®çš„å¸ƒå°”å€¼æ¥åˆ¤æ–­ï¼Œè¿˜è¦çœ‹è¯¥å¸§æœ¬æ¥çš„æƒ…å†µã€‚)</p><h3 id="Size"><a href="#Size" class="headerlink" title="Size () :"></a>Size () :</h3><p>è¿”å›å½“å‰åœ¨ <code>LRUKReplace</code> ä¸­çš„å¯é©±é€å¸§çš„æ•°é‡ã€‚</p><h2 id="Task2-Disk-Scheduler"><a href="#Task2-Disk-Scheduler" class="headerlink" title="Task2 Disk Scheduler"></a>Task2 Disk Scheduler</h2><p>è¯¥ç»„ä»¶è´Ÿè´£è°ƒåº¦ DiskManager ä¸Šçš„è¯»å†™æ“ä½œã€‚åœ¨ <code>disk_scheduler.h</code> ä¸­å®ç°ä¸€ä¸ªåä¸º DiskScheduler çš„æ–°ç±»ï¼Œå¹¶åœ¨ <code>disk_scheduler.cpp</code> ä¸­å®ç°ç›¸åº”çš„å®ç°æ–‡ä»¶ã€‚<br>è¦å®ç°çš„ä¸¤ä¸ªæ–¹æ³•ï¼š</p><h3 id="Schedule-DiskRequest-r"><a href="#Schedule-DiskRequest-r" class="headerlink" title="Schedule(DiskRequest r):"></a>Schedule(DiskRequest r):</h3><p>è°ƒåº¦è¯·æ±‚ã€‚å³å°†è¯·æ±‚råŠ å…¥åˆ°é˜Ÿåˆ—ä¸­æ’é˜Ÿä»¥ç­‰å¾…DiskManageræ‰§è¡Œè¯»å†™ã€‚</p><h3 id="StartWorkerThread"><a href="#StartWorkerThread" class="headerlink" title="StartWorkerThread():"></a>StartWorkerThread():</h3><p>åå°å·¥ä½œçº¿ç¨‹çš„å¯åŠ¨æ–¹æ³•ï¼Œç”¨äºå¤„ç†è®¡åˆ’è¯·æ±‚ã€‚å·¥ä½œçº¿ç¨‹åœ¨ DiskScheduler æ„é€ å‡½æ•°ä¸­åˆ›å»ºï¼Œå¹¶è°ƒç”¨æ­¤æ–¹æ³•ã€‚è¯¥æ–¹æ³•è´Ÿè´£è·å–é˜Ÿåˆ—ä¸­çš„è¯·æ±‚å¹¶å°†å…¶åˆ†æ´¾ç»™ DiskManagerè¿›è¡Œpage read or page writeã€‚åœ¨è°ƒç”¨ DiskScheduler çš„ææ„å‡½æ•°ä¹‹å‰ï¼Œè¯¥æ–¹æ³•ä¸åº”è¿”å›ã€‚<br>å…¶ä¸­é˜Ÿåˆ—å¯ä»¥ç›´æ¥ç”¨æä¾›çš„<code>Channel</code>ç±»ï¼Œå…¶åŒ…æ‹¬Putå’ŒGetä¸¤ä¸ªæ–¹æ³•ï¼ŒGetè‡ªå¸¦äº†ç­‰å¾…çš„ç¯èŠ‚ï¼Œåœ¨è·å–è¯·æ±‚æ—¶æ–¹ä¾¿äº†å¾ˆå¤šã€‚<br>è¿™ä¸ªTaskçš„å…³é”®æ˜¯è¯»æ‡‚æ–‡æ¡£å’Œæ³¨é‡Šï¼Œæˆ‘ä»¬çœ‹å¯åŠ¨ä»£ç ï¼Œåœ¨DiskSchedulerçš„ææ„å‡½æ•°ä¸­æœ‰:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// Put a `std::nullopt` in the queue to signal to exit the loop</span><br>request_queue_.<span class="hljs-built_in">Put</span>(std::<span class="hljs-literal">nullopt</span>);<br></code></pre></td></tr></table></figure><p>è‡ªç„¶åœ°ï¼Œåœ¨StartWorkerThreadä¸­æˆ‘ä»¬å°±æ˜¯ä¸€ä¸ªwhile(true)ï¼Œç›´åˆ°Getåˆ°çš„é˜Ÿåˆ—æ˜¯ææ„å‡½æ•°å‘å‡ºçš„ä¿¡å·ï¼šnulloptã€‚é€€å‡ºå¾ªç¯ï¼Œå¯¹äºå…¶ä»–æ­£å¸¸çš„è¯·æ±‚ï¼Œæˆ‘ä»¬åˆ†é…ç»™DiskManagerè¿›è¡Œå¯¹ç£ç›˜çš„è¯»å†™æ“ä½œï¼Œ<strong>æ³¨æ„ï¼Œè¿™é‡Œè¯»å†™å®Œä¸€å®šè¦å¯¹call_backè®¾ç½®trueå€¼ä»¥å®ç°å¼‚æ­¥å¤„ç†</strong>ã€‚<br>ä¸€ä¸ªè¯­æ³•çš„ç‚¹ï¼šä¼ DiskRequestæ—¶ï¼Œè®°å¾—åŠ ä¸Šstd::move</p><h2 id="Task3-Buffer-Pool-Manager"><a href="#Task3-Buffer-Pool-Manager" class="headerlink" title="Task3 Buffer Pool Manager"></a>Task3 Buffer Pool Manager</h2><p>ç³»ç»Ÿä¸­çš„æ‰€æœ‰å†…å­˜ä¸­é¡µéƒ½ç”± Page å¯¹è±¡è¡¨ç¤ºã€‚Page å¯¹è±¡åªæ˜¯ç¼“å†²æ± ä¸­çš„å†…å­˜å®¹å™¨ï¼Œå› æ­¤ä¸æ˜¯ç‰¹å®šäºå”¯ä¸€é¡µé¢çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ª Page å¯¹è±¡éƒ½åŒ…å«ä¸€å—å†…å­˜ï¼Œ<strong>ç›¸åŒ</strong>çš„ Page å¯¹è±¡å¯èƒ½åœ¨æ•´ä¸ªç³»ç»Ÿç”Ÿå‘½å‘¨æœŸä¸­åŒ…å«<strong>ä¸åŒ</strong>çš„ç‰©ç†é¡µï¼Œ<code>Page</code>åªæ˜¯å†…å­˜çš„æŠ½è±¡ã€‚Page å¯¹è±¡çš„æ ‡è¯†ç¬¦(Page _ id)è·Ÿè¸ªå®ƒåŒ…å«çš„ç‰©ç†é¡µé¢; å¦‚æœ Page å¯¹è±¡ä¸åŒ…å«ç‰©ç†é¡µé¢ï¼Œé‚£ä¹ˆå®ƒçš„ Page _ id å¿…é¡»è®¾ç½®ä¸º <code>INVALID _ PAGE _ ID</code>ã€‚<br>æ¯ä¸ª Page å¯¹è±¡è¿˜ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨äºè®¡ç®—<code>pinned</code>è¯¥é¡µé¢çš„çº¿ç¨‹æ•°ã€‚ä¸èƒ½é‡Šæ”¾è¢«<code>pinned</code>çš„ Pageã€‚æ¯ä¸ª Page å¯¹è±¡è¿˜è·Ÿè¸ªå®ƒæ˜¯å¦æ˜¯<code>dirty</code>ã€‚ å¿…é¡»å°†<code>dirty Page</code>å†™å›ç£ç›˜ï¼Œç„¶åæ‰èƒ½é‡ç”¨è¯¥å¯¹è±¡ã€‚<br>BufferPoolManager å®ç°å°†ä½¿ç”¨Task1ä¸­åˆ›å»ºçš„ LRUKReplace ç±»è·Ÿè¸ª Page å¯¹è±¡ä½•æ—¶è¢«è®¿é—®(å°† page _ id æ˜ å°„åˆ° frame _ id)ï¼Œä»¥ä¾¿åœ¨å¿…é¡»é‡Šæ”¾ä¸€ä¸ª<code>frame</code>ä»¥è…¾å‡ºç©ºé—´ä»ç£ç›˜å¤åˆ¶ä¸€ä¸ªæ–°çš„ç‰©ç†é¡µé¢æ—¶å†³å®š<code>evict</code>å“ªä¸ªå¯¹è±¡ã€‚åŒæ—¶ä½¿ç”¨Task2ä¸­åˆ›å»ºçš„è°ƒåº¦å™¨æ¥å®ç°å¯¹<code>dirty page</code>çš„å†™å…¥ï¼Œå’Œ<code>fetchpage</code>æ—¶å¯¹pageçš„è¯»å–ã€‚<strong>å› æ­¤ï¼Œå»ºè®®ç¡®ä¿å‰ä¸¤ä¸ªç±»å®ç°æ²¡é—®é¢˜çš„æƒ…å†µä¸‹å†è¿›è¡ŒTaskçš„ä½œä¸šï¼Œèƒ½å…å»å¾ˆå¤šæ— æ•ˆçš„å†…è€—æ£€æŸ¥(</strong>.<br>åœ¨<code>buffer pool manager.cpp</code>ä¸­å®ç°ï¼š</p><h3 id="NewPage-page-id-t-page-id"><a href="#NewPage-page-id-t-page-id" class="headerlink" title="NewPage(page_id_t* page_id) :"></a>NewPage(page_id_t* page_id) :</h3><p>æ–°å»ºé¡µï¼Œå‡ ä¸ªæ­¥éª¤ï¼š</p><ol><li>é€šè¿‡<code>AllocatePage()</code> è·å¾—æ–°çš„page_id</li><li>å†å–frameå¸§è·Ÿè¸ªpageï¼Œå…ˆä»freelisté‡Œå–ï¼Œè‹¥æ²¡æœ‰å†åˆ°replacer_é‡Œå»evict(è‡³æ­¤ï¼ŒPageç»“æ„çš„ä¸¤ä¸ªé‡è¦æ•°æ®<code>page_id å’Œ frame_id</code>éƒ½å·²å¾—åˆ°)</li><li>åˆå§‹åŒ–Pageï¼Œèµ‹å€¼ç›¸å…³çš„å±æ€§ï¼Œå¹¶å°†å…¶åŠ å…¥åˆ°<code>Page_table</code>ä¸­ã€‚</li><li><code>pin</code>Page : <ol><li>æ·»åŠ è®¿é—®è®°å½•</li><li>è®¾ç½®ä¸å¯é©±é€</li><li>pin_cout ++</li></ol></li></ol><h3 id="FetchPage-page-id-t-page-id"><a href="#FetchPage-page-id-t-page-id" class="headerlink" title="FetchPage(page_id_t page_id)"></a>FetchPage(page_id_t page_id)</h3><p>å–é¡µï¼Œåˆ†ä¸¤ç§æƒ…å†µï¼š</p><ol><li>pageå·²åœ¨æ± é‡Œï¼Œåˆ™ç›´æ¥pinè¯¥page</li><li>pageä¸åœ¨æ± ä¸­ï¼šå…ˆå–è·Ÿè¸ªè¯¥pageçš„å¸§(è‹¥freelistå’Œreplacer_ä¸­éƒ½å·²ç©ºï¼Œæ— æ³•è·Ÿè¸ªè¯¥å¸§ï¼Œè¿”å›nullptr)ï¼Œåç”Ÿæˆæ–°çš„pageé¡µï¼Œå¹¶ä½¿ç”¨è°ƒåº¦å™¨è¯»å–è¯¥page_idç‰©ç†é¡µä¸Šçš„å†…å®¹ã€‚æ³¨æ„ç”±äºå¹¶å‘çš„å­˜åœ¨ï¼Œè¿™é‡Œè¯»ç£ç›˜æ—¶ï¼Œä¸€å®šè¦ç­‰å¾…è¯»å–å®Œæˆï¼Œ(<code>future.get()</code>)ã€‚å¯¹pageå®Œå–„åï¼ŒåŒæ ·åœ°ï¼Œpin page.</li></ol><h3 id="UnpinPage-page-id-t-page-id-bool-is-dirty"><a href="#UnpinPage-page-id-t-page-id-bool-is-dirty" class="headerlink" title="UnpinPage(page_id_t page_id, bool is_dirty)"></a>UnpinPage(page_id_t page_id, bool is_dirty)</h3><p>å–æ¶ˆå¯¹æŸé¡µçš„å¼•ç”¨ï¼Œä»£ç ä¸Šè¡¨ç°ä¸ºï¼šæ‰¾åˆ°pageï¼Œå°†å…¶<code>pin count</code>å‡1ï¼Œè‹¥å‡å®Œå<code>pin count</code>ä¸º0ï¼Œåˆ™è®¾ç½®è¯¥pageå¯é©±é€ã€‚è®¾ç½®is_dirtyæ ‡å¿—æŒ‡ç¤ºå‰åæ˜¯å¦æ”¹å˜(<strong>æ³¨æ„ä¸€ä¸ªé¡µä¼šæœ‰è®¸å¤šå¼•ç”¨ï¼Œä¸€ä¸ªå¼•ç”¨æ²¡ä¿®æ”¹è¯¥é¡µä¸ä»£è¡¨å¦å¤–çš„é¡µæ²¡ä¿®æ”¹ï¼Œåªè¦ä¸€ä¸ªå¼•ç”¨ä¿®æ”¹äº†è¯¥é¡µï¼Œé‚£ä¹ˆè¯¥é¡µå°±æ˜¯dirty pageã€‚å› æ­¤è¿™é‡Œä¸æ˜¯ç®€å•åœ°èµ‹å€¼ï¼Œè€Œæ˜¯è¦ç”¨æˆ–è¿ç®—</strong>)</p><h3 id="FlushPage-page-id-t-page-id"><a href="#FlushPage-page-id-t-page-id" class="headerlink" title="FlushPage(page_id_t page_id)"></a>FlushPage(page_id_t page_id)</h3><p>æ— è®ºè¯¥é¡µçŠ¶æ€å¦‚ä½•ï¼Œå°†å…¶å†…å®¹å†™å…¥ç£ç›˜ã€‚åŒæ—¶è®¾ç½®<code>is_dirty</code> ä¸º falseã€‚åŒæ ·åœ°ï¼Œåƒä¸Šè¿°FetchPageæåˆ°ï¼Œåœ¨ç£ç›˜æ“ä½œçš„æ—¶å€™ï¼Œä¸€å®šè¦ç­‰å¾…æ“ä½œå®Œæˆã€‚</p><h3 id="FlushAllPages"><a href="#FlushAllPages" class="headerlink" title="FlushAllPages()"></a>FlushAllPages()</h3><p>å¯¹è®°å½•çš„pageè°ƒç”¨FlushPage</p><h3 id="DeletePage-page-id-t-page-id"><a href="#DeletePage-page-id-t-page-id" class="headerlink" title="DeletePage(page_id_t page_id)"></a>DeletePage(page_id_t page_id)</h3><p>åˆ é™¤é¡µï¼Œè‹¥æ‰¾ä¸åˆ°è¯¥é¡µï¼Œç›´æ¥è¿”å›trueã€‚è‹¥è¯¥é¡µè¢«pinï¼Œæ— æ³•åˆ é™¤ï¼Œè¿”å›falseã€‚å°†pageä»page_tableåˆ é™¤ï¼ŒåŒæ—¶å–æ¶ˆå¯¹å…¶çš„è·Ÿè¸ªï¼Œå°†å¸§ç§»å‡ºreplacerå¹¶åŠ å…¥åˆ°freelistä¸­ï¼Œresetè¯¥é¡µçš„å…ƒæ•°æ®ï¼Œæœ€åè°ƒç”¨DeallocatePage(å®ƒæ¨¡æ‹Ÿåœ¨ç£ç›˜ä¸Šé‡Šæ”¾é¡µé¢)ã€‚</p><h2 id="AGæµ‹è¯•"><a href="#AGæµ‹è¯•" class="headerlink" title="AGæµ‹è¯•"></a>AGæµ‹è¯•</h2><p>å½“ä½ é€šè¿‡äº†æœ¬åœ°æµ‹è¯•ï¼Œ<code>make submit-p1</code>æ»¡æ€€è‡ªä¿¡åœ°å»ä¸Šä¼ agæ—¶ï¼Œä¸€ç‰‡çº¢è®©ä½ æ€€ç–‘äººç”Ÿ(æœ¬åœ°æµ‹è¯•ç”¨ä¾‹å®åœ¨å¤ªå°‘äº†ï¼Œå»ºè®®è¯»è€…è‡ªå·±å¤šå†™å‡ ä¸ªæµ‹è¯•å®ç°ï¼Œè€Œä¸æ˜¯åƒæˆ‘ä¸€æ ·æŠŠagå½“debugæœºå™¨)</p><p>æä¸¤ä¸ªè¸©çš„å‘:</p><ol><li>é‡åˆ°è¶…æ—¶ï¼Œå¤§æ¦‚ç‡æ˜¯æ­»é”é—®é¢˜</li><li>å…³äºå†…å­˜æ³„æ¼ï¼Œå¯¹äºreplacer_ä¸­åˆ›é€ çš„LRUKNodeèŠ‚ç‚¹ï¼Œè®°å¾—åœ¨ææ„å‡½æ•°destroy replacerçš„æ—¶å€™åˆ é™¤</li><li>å…³äº<em>BufferPoolManagerTest.HardTest_4</em>ï¼ŒæŠŠBufferPoolManagerå‡½æ•°ä¸­çš„é”æ¢æˆ: <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function">std::scoped_lock&lt;std::mutex&gt; <span class="hljs-title">locker</span><span class="hljs-params">(latch_)</span></span>;<br></code></pre></td></tr></table></figure>å³å¯è§£å†³ã€‚</li></ol><p>ç¥å¤§å®¶éƒ½èƒ½æ»¡åˆ†é€šè¿‡ :ï¼‰</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>CMU15-445 Proj0.C++ Primer</title>
    <link href="/2023/11/18/Proj0.C++%20Primer/"/>
    <url>/2023/11/18/Proj0.C++%20Primer/</url>
    
    <content type="html"><![CDATA[<p>å…ˆæ”¾é€šè¿‡æˆªå›¾(23sp)ï¼š<br><img src="/../images/0.jpg"><br>15-445çš„å…¥è¯¾cppæµ‹è¯•(CMUçš„å­¦ç”Ÿé€šä¸è¿‡çš„è¯ä¼šè¢«é€€è¯¾ğŸ˜¨)ï¼Œç”±äºæœ¬äººæ²¡æœ‰cppåŸºç¡€ï¼Œåœ¨å„ç§è¯­æ³•ä¸Šè¿˜æ˜¯æŒ£æ‰äº†å¾ˆä¹…ï¼ŒåŒ…æ‹¬æ¨¡ç‰ˆã€æ™ºèƒ½æŒ‡é’ˆç­‰ï¼Œè‹¥è¯»è€…è¦åˆ·è¿™é—¨è¯¾ï¼Œè¿˜æ˜¯è¦å…ˆå­¦ä¸€ä¸‹è¿™äº›çŸ¥è¯†ï¼Œå¦åˆ™å°±æ˜¯ç—›è‹¦åœ°è·Ÿç¼–è¯‘ä½œæ–—äº‰:(<br><a href="https://15445.courses.cs.cmu.edu/spring2023/project0/">Projé“¾æ¥</a></p><h2 id="Task1-Copy-On-Write-Trie"><a href="#Task1-Copy-On-Write-Trie" class="headerlink" title="Task1 Copy-On-Write Trie"></a>Task1 Copy-On-Write Trie</h2><p>ä¿®æ”¹<code>trie.h</code>å’Œ<code>trie.cpp</code>æ–‡ä»¶æ¥å®ç°ä¸€ä¸ªCOWçš„Trieï¼Œå…³é”®ç‚¹å°±æ˜¯æˆ‘ä»¬ä¸åœ¨åŸæœ¬çš„Trieä¸Šæ“ä½œï¼Œè€Œæ˜¯é‡ç”¨ä¸å˜çš„æ—§èŠ‚ç‚¹ï¼Œåˆ›å»ºä¿®æ”¹åçš„æ–°çš„èŠ‚ç‚¹ï¼Œè€Œåè¿”å›æ–°çš„æ ¹ã€‚</p><p>task1ä¸­è¦å®ç°ä¸‰ä¸ªæ–¹æ³•ï¼š</p><h3 id="Get-key"><a href="#Get-key" class="headerlink" title="Get(key)"></a>Get(key)</h3><p>æ„ä¹‰æ˜ç¡®ï¼Œè¿”å›ä¸é”®å¯¹åº”çš„å€¼ï¼Œæ€è·¯ä¹Ÿå¾ˆæ˜¾ç„¶ï¼šéå†æ•´ä¸ªTrieï¼Œæ‰¾åˆ°keyå¯¹åº”çš„TrieNodeã€‚ä¸»è¦è¿˜æ˜¯ä¸€äº›è¯­æ³•ä¸Šçš„é—®é¢˜ã€ç¼–è¯‘ä¸Šçš„é”™è¯¯ã€‚æœ‰ä¸ªæ³¨æ„ç‚¹æ˜¯ï¼Œå¯åŠ¨ä»£ç æ³¨é‡Šä¸­æåˆ°çš„å¼ºåˆ¶ç±»å‹è½¬æ¢:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// After you find the node, you should use `dynamic_cast` to cast it to `const TrieNodeWithValue&lt;T&gt; *`.</span><br></code></pre></td></tr></table></figure><h3 id="Put-key"><a href="#Put-key" class="headerlink" title="Put(key)"></a>Put(key)</h3><p>åœ¨é”®ä¸Šå†™å…¥å€¼æˆ–è¦†ç›–å€¼ã€‚éš¾äºGetæ–¹æ³•çš„ç‚¹åœ¨äºï¼Œéœ€è¦å¯¹<strong>èŠ‚ç‚¹</strong>è¿›è¡Œæ“ä½œã€‚è‡ªç„¶åœ°ï¼Œæˆ‘ä»¬ä¸€å®šä¼šåˆ›å»ºä¸€ä¸ªå¸¦ç€æ–°å€¼çš„è¯¥é”®çš„èŠ‚ç‚¹ï¼Œç„¶åå°†è¯¥èŠ‚ç‚¹åŠ å…¥åˆ°å…¶çˆ¶èŠ‚ç‚¹çš„children mapä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ª<strong>è‡ªåº•å‘ä¸Š</strong>çš„è¿‡ç¨‹ï¼Œå› æ­¤åœ¨éå†åˆ°é”®çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æƒ³åˆ°å°†ä¹‹å‰ç›¸åŒçš„èŠ‚ç‚¹å­˜å…¥ä¸€ä¸ªæ ˆä¸­ã€‚è€Œåå®Œæˆä¸€å±‚å±‚çš„æ“ä½œã€‚<br>å› æ­¤è¯¥è¿‡ç¨‹å¤§è‡´ä¸ºï¼š</p><ol><li>éå†åˆ°é”®ï¼Œä¸”æŠŠç›¸åŒçš„èŠ‚ç‚¹å‹å…¥åˆ°æ ˆä¸­ã€‚</li><li>åˆ›å»ºè¦putçš„èŠ‚ç‚¹</li><li>è‡ªåº•å‘ä¸Šå¤åˆ¶èŠ‚ç‚¹</li><li>è¿”å›æ–°çš„Trie</li></ol><p>æœ‰ä¸ªæ³¨æ„ç‚¹åŒæ ·åœ¨æ³¨é‡Šä¸­:</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// Note that `T` might be a non-copyable type. Always use `std::move` when creating `shared_ptr` on that value.</span><br></code></pre></td></tr></table></figure><h3 id="Remove-key"><a href="#Remove-key" class="headerlink" title="Remove(key)"></a>Remove(key)</h3><p>åˆ é™¤é”®çš„å€¼ï¼Œç”±äºè¦æ“ä½œèŠ‚ç‚¹ï¼Œå› æ­¤æ€»ä½“æµç¨‹ä¸<code>Put</code>æ–¹æ³•ç±»ä¼¼ï¼Œéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯æˆ‘ä»¬éœ€è¦<strong>åˆ é™¤</strong>é‚£äº›<br>æ²¡æœ‰<code>children_</code>å¹¶ä¸”ä¸ä¸º<strong>å€¼èŠ‚ç‚¹</strong>çš„èŠ‚ç‚¹ï¼Œ(RemoveFreeTestæµ‹è¯•è€ƒå¯Ÿäº†è¿™ä¸€ç‚¹)</p><p>è‡³æ­¤Task1ç»“æŸï¼Œä¸»è¦æ˜¯ç†Ÿæ‚‰trie.hçš„å„ç§å®šä¹‰ã€‚</p><p>æµ‹è¯•å®ç°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd build<br>make trie_test trie_store_test -j$(nproc)<br>make trie_noncopy_test trie_store_noncopy_test -j$(nproc)<br>./test/trie_test<br>./test/trie_noncopy_test<br></code></pre></td></tr></table></figure><h2 id="Task2-å¹¶å‘å­˜å‚¨"><a href="#Task2-å¹¶å‘å­˜å‚¨" class="headerlink" title="Task2 å¹¶å‘å­˜å‚¨"></a>Task2 å¹¶å‘å­˜å‚¨</h2><p>ä¿®æ”¹<code>trie_store.cpp</code>å®ç°å¯¹Trieçš„å¹¶å‘æ“ä½œï¼Œå­¦è¿‡OSçš„åº”è¯¥éƒ½ä¸é™Œç”Ÿï¼Œå½“å¯¹Trieå¹¶å‘åœ°è¿›è¡Œæ“ä½œæ—¶ï¼Œå°±éœ€è¦åŠ ä¸Šé”äº†ï¼Œæ­¤Taskå°±æ˜¯å®ç°è¿™ä¸ªã€‚æ²¡ä»€ä¹ˆå¯è®²çš„ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨Task1å®ç°çš„å‡½æ•°ï¼Œæ“ä½œæ—¶åŠ ä¸Šå¯¹åº”çš„é”å°±è¡Œã€‚</p><p>æµ‹è¯•å®ç°:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd build<br>make trie_test trie_store_test -j$(nproc)<br>make trie_noncopy_test trie_store_noncopy_test -j$(nproc)<br>./test/trie_store_test<br>./test/trie_store_noncopy_test<br></code></pre></td></tr></table></figure><h2 id="Task3-è°ƒè¯•"><a href="#Task3-è°ƒè¯•" class="headerlink" title="Task3 è°ƒè¯•"></a>Task3 è°ƒè¯•</h2><p>éœ€è¦åœ¨<code>trie_answer.h</code>ä¸­å¡«å…¥æœ‰å…³<code>trie_debug_test.cpp</code>ä¸­trieç»“æ„çš„ä¿¡æ¯ï¼Œéšæœºæ•°ç”Ÿæˆä¸ä¸€æ ·ï¼Œå¯ä»¥å°†trieç»“æ„åˆå§‹åŒ–æ”¹æˆï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">auto</span> trie = <span class="hljs-built_in">Trie</span>();<br>trie = trie.<span class="hljs-built_in">Put</span>&lt;<span class="hljs-type">uint32_t</span>&gt;(<span class="hljs-string">&quot;65&quot;</span>, <span class="hljs-number">25</span>);<br>trie = trie.<span class="hljs-built_in">Put</span>&lt;<span class="hljs-type">uint32_t</span>&gt;(<span class="hljs-string">&quot;61&quot;</span>, <span class="hljs-number">65</span>);<br>trie = trie.<span class="hljs-built_in">Put</span>&lt;<span class="hljs-type">uint32_t</span>&gt;(<span class="hljs-string">&quot;82&quot;</span>, <span class="hljs-number">84</span>);<br>trie = trie.<span class="hljs-built_in">Put</span>&lt;<span class="hljs-type">uint32_t</span>&gt;(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-number">42</span>);<br>trie = trie.<span class="hljs-built_in">Put</span>&lt;<span class="hljs-type">uint32_t</span>&gt;(<span class="hljs-string">&quot;16&quot;</span>, <span class="hljs-number">67</span>);<br>trie = trie.<span class="hljs-built_in">Put</span>&lt;<span class="hljs-type">uint32_t</span>&gt;(<span class="hljs-string">&quot;94&quot;</span>, <span class="hljs-number">53</span>);<br>trie = trie.<span class="hljs-built_in">Put</span>&lt;<span class="hljs-type">uint32_t</span>&gt;(<span class="hljs-string">&quot;20&quot;</span>, <span class="hljs-number">35</span>);<br>trie = trie.<span class="hljs-built_in">Put</span>&lt;<span class="hljs-type">uint32_t</span>&gt;(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-number">57</span>);<br>trie = trie.<span class="hljs-built_in">Put</span>&lt;<span class="hljs-type">uint32_t</span>&gt;(<span class="hljs-string">&quot;93&quot;</span>, <span class="hljs-number">30</span>);<br>trie = trie.<span class="hljs-built_in">Put</span>&lt;<span class="hljs-type">uint32_t</span>&gt;(<span class="hljs-string">&quot;75&quot;</span>, <span class="hljs-number">29</span>);<br></code></pre></td></tr></table></figure><p>ç„¶åæ ¹æ®è¦æ±‚ï¼Œè¾“å‡ºçœ‹ç»“æœï¼Œå¡«å…¥ç­”æ¡ˆå³å¯ã€‚(æ„Ÿè§‰æ˜¯å¾ˆæ— è¶£çš„ä¸€ç¯)</p><h2 id="Task4-SQL-String-Functions"><a href="#Task4-SQL-String-Functions" class="headerlink" title="Task4 SQL String Functions"></a>Task4 SQL String Functions</h2><p>åœ¨<code>string_expression.h</code>ä¸­åŠ å…¥å¤§å°å†™è½¬æ¢çš„åŠŸèƒ½ã€‚åœ¨<code>plan_func_call.cpp</code>ä¸­å®ç°å¯¹åˆšæ‰å†™çš„åŠŸèƒ½çš„è°ƒç”¨(è·Ÿç€æ³¨é‡Šæ¥å†™å°±å¥½)</p><p>æµ‹è¯•å®ç°:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd build<br>make -j`nproc` shell<br>./bin/bustub-shell<br><span class="hljs-meta prompt_">bustub&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> upper(<span class="hljs-string">&#x27;AbCd&#x27;</span>), lower(<span class="hljs-string">&#x27;AbCd&#x27;</span>);</span><br></code></pre></td></tr></table></figure><p>ç»“æœå‡ºç°<code>ABCD abcd</code>å³æ­£ç¡®ã€‚</p><h2 id="æäº¤ä»£ç "><a href="#æäº¤ä»£ç " class="headerlink" title="æäº¤ä»£ç "></a>æäº¤ä»£ç </h2><h3 id="Format"><a href="#Format" class="headerlink" title="Format"></a>Format</h3><p>å…¬å¼€è¯¾çš„ç‰¹è‰²ä¹‹ä¸€ï¼šStyle Checkï¼Œ<br>å®˜æ–¹ç»™å‡ºçš„ä¸‰è¡Œå‘½ä»¤æ£€æŸ¥ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">make format</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">make check-lint</span><br><span class="hljs-meta prompt_">$ </span><span class="language-bash">make check-clang-tidy-p0</span><br></code></pre></td></tr></table></figure><p>åœ¨æ­¤agä¸­ï¼Œä¸æ»¡è¶³ä¸Šè¿°ä¸‰ç§è§„åˆ™çš„ä»£ç ä¼šç›´æ¥è¯„0åˆ†ã€‚<br>ç”±äºæœ¬äººåœ¨terminalä¸‹åªèƒ½æ‰§è¡Œç¬¬äºŒæ¡å‘½ä»¤ï¼Œç¬¬ä¸€æ¡å’Œç¬¬ä¸‰æ¡éƒ½æŠ¥é”™ï¼Œè½¬è€Œä½¿ç”¨äº†vscodeçš„è‡ªåŠ¨æ ¼å¼åŒ–ï¼š<br>åœ¨Macosçš„ç¯å¢ƒä¸‹å¤§è‡´é…ç½®å¦‚ä¸‹ï¼š</p><ol><li>åœ¨vscodeæ‹“å±•ä¸­å®‰è£…<code>Clang-Format</code></li><li>é˜…è¯»readme,åœ¨.vscodeæ–‡ä»¶å¤¹ä¸‹çš„<code>settings.json</code>ä¸­é…ç½®å¦‚ä¸‹ä¸¤è¡Œ:<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;editor.formatOnSave&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–</span><br><span class="hljs-attr">&quot;clang-format.executable&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;/absolute/path/to/clang-format&quot;</span> <span class="hljs-comment">// è·¯å¾„(ç­‰ä¸‹è¦æ”¹)</span><br></code></pre></td></tr></table></figure></li><li>è‹¥å®‰è£…è¿‡brew,åœ¨terminalä¸­å®‰è£…format:<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">brew install clang-format<br></code></pre></td></tr></table></figure></li><li>è·å–formatè·¯å¾„ï¼Œåœ¨terminalä¸­è¾“å…¥<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">which clang-format<br></code></pre></td></tr></table></figure></li><li>å°†è¾“å‡ºç»“æœå¤åˆ¶è¦†ç›–ä¸Šè¿°jsonæ–‡ä»¶çš„è·¯å¾„ã€‚</li><li>åœ¨vscodeä¸­æ‰“å¼€è¦æ ¼å¼åŒ–çš„ä»£ç æ–‡ä»¶ï¼Œcmd+sä¿å­˜å³å¯è‡ªåŠ¨æ ¼å¼åŒ–ã€‚<br>æ­¤æ—¶åº”è¯¥æ»¡è¶³å®˜æ–¹çš„å‰ä¸¤æ¡è§„åˆ™ï¼Œç¬¬ä¸‰æ¡æ˜¯æœ‰å…³ä»£ç æœ¬èº«ï¼ŒåŒ…æ‹¬å˜é‡å‘½åçš„è§„èŒƒï¼Œå¾ªç¯æ¡ä»¶çš„å†—ä½™ç­‰ç­‰ã€‚(è‹¥å®‰è£…äº†<code>clangd</code>æ‹“å±•ï¼Œåœ¨ideä¸­ä¼šå¦‚ç¼–è¯‘é”™è¯¯ä¸€æ ·æ ‡çº¢æ˜¾ç¤ºï¼Œæ³¨æ„è¿›è¡Œä¿®æ”¹)</li></ol><p>å½“ä¸€åˆ‡å®Œæˆï¼Œæ‰“åŒ…æ–‡ä»¶ï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">cd build<br>make submit-p0<br></code></pre></td></tr></table></figure><p>ä¼šåœ¨æ ¹ç›®å½•ä¸‹è‡ªåŠ¨ç”Ÿæˆ<em>proj0-submission.zip</em>å‹ç¼©åŒ…ï¼Œä¸Šä¼ ag(æ— æ³•ç›´æ¥å¯¼å…¥githubåº“)ï¼Œè™”è¯šåœ°ç­‰å¾…æ‰“åˆ†â€¦â€¦</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2023/11/08/hello-world/"/>
    <url>/2023/11/08/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
